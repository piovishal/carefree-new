(function(b,a){'use strict';var d=function(b,c){return!!(this.targets=a(b),this.settings=a.extend({},a.fn.tcToolTip.defaults,c),this.targets.length>0)&&(this.init(),this)},c;a(function(){c=b.TMEPOJS||{tm_epo_global_tooltip_max_width:'340px'}}),d.prototype={constructor:d,removeTooltip:function(c,e){var d=this.settings;if(c.data('is_moving'))return;e.removeClass(d.fadin).addClass(d.fadeout),e.animate({opacity:0},d.speed,function(){a(this).remove()}),c.data('tmtip-title')&&c.data('tm-tip-html')===void 0&&!c.attr('data-tm-tooltip-html')&&c.attr('title',c.data('tmtip-title')),a(b).off('scroll.tcToolTip resize.tcToolTip'),d.onetime&&this.destroy()},initTooltip:function(e,d,i){var j=this.settings,h,k,f,g,l,m;e&&d&&e.length===1&&d.length===1&&e.data('tm-has-tm-tip')===1&&(i===1&&(e.data('tm-tip-html')!==void 0?h=e.data('tm-tip-html'):e.attr('data-tm-tooltip-html')?h=e.attr('data-tm-tooltip-html'):h=e.attr('title'),d.html(h),e.data('is_moving',!0)),d.find('aside').hide(),c.tm_epo_global_tooltip_max_width===''?a(b).width()<=d.outerWidth()*1.2?d.css('max-width',a(b).width()/1.2+'px'):d.css('max-width','340px'):(c.tm_epo_global_tooltip_max_width.isNumeric()&&(c.tm_epo_global_tooltip_max_width=c.tm_epo_global_tooltip_max_width+'px'),d.css('max-width',c.tm_epo_global_tooltip_max_width)),d.find('aside').show(),d.css({left:'',right:'',top:''}),k=a.epoAPI.dom.scroll(),f=e.offset().left+e.outerWidth()/2-d.outerWidth()/2,m=f,f<0?(f=e.offset().left+e.outerWidth()/2-20,d.addClass('left')):d.removeClass('left'),m>=0&&f+d.outerWidth()>a(b).width()?(f=e.offset().left-d.outerWidth()+e.outerWidth()/2+20,f<0&&(f=f-10,d.css('max-width','calc('+d.css('max-width')+' - '+Math.abs(f)+'px)'),f=10),d.addClass('right')):d.removeClass('right'),d.css({left:f,right:'auto',top:g}),g=e.offset().top-d.outerHeight()-10,l=e.offset().top-k.top-d.outerHeight()-10,g<0||l<0?(g=e.offset().top+e.outerHeight()+10,d.addClass('top'),d.removeClass('bottom')):(d.removeClass('top'),d.addClass('bottom')),a(b).trigger('tm_tooltip_show'),i?(d.css({left:f,top:g}),e.data('is_moving',!1)):d.css({left:f,top:g}).removeClass(j.fadeout).addClass(j.fadin))},show:function(c){var f=this.settings,e,g,d;if(c.data('is_moving'))return;return c.data('tm-has-tm-tip')===1&&(c.data('tm-tip-html')!==void 0?(e=c.data('tm-tip-html'),c.attr('title')&&c.data('tmtip-title',c.attr('title')),c.removeAttr('title')):c.attr('data-tm-tooltip-html')?(e=c.attr('data-tm-tooltip-html'),c.attr('title')&&c.data('tmtip-title',c.attr('title')),c.removeAttr('title')):e=c.attr('title'),e!==void 0&&(a('#tm-tooltip').remove(),f.tipclass?f.tipclass=' '+f.tipclass:f.tipclass='',d=a('<div id="tm-tooltip" class="tm-tip tm-animated'+f.tipclass+'"></div>'),d.css('opacity',0).html(e).appendTo('body'),g=d.find('img'),g.length>0&&g.on('load',this.initTooltip.bind(this,c,d)),this.initTooltip(c,d),a(b).on('scroll.tcToolTip resize.tcToolTip',this.initTooltip.bind(this,c,d)),c.data('is_moving',!1),c.on('tmmovetooltip',this.initTooltip.bind(this,c,d,1)),c.on('mouseleave.tc tmhidetooltip',this.removeTooltip.bind(this,c,d)),c.closest('label').on('mouseleave.tc tmhidetooltip',this.removeTooltip.bind(this,c,d)),d.on('click',this.removeTooltip.bind(this,c,d)))),!1},destroy:function(){this.targets.length>0&&(this.targets.toArray().forEach(function(c){var b=a(c);b.closest('off').on('mouseleave.tc tmhidetooltip'),b.off('tc-tooltip-html-changed tmmovetooltip tmhidetooltip mouseenter.tc mouseleave.tc tmshowtooltip.tc'),b.removeData('tmtip-title'),b.removeData('tm-tip-html')}),this.targets.removeData('tctooltip tm-has-tm-tip is_moving'))},init:function(){var b=this,c=this.settings;this.targets.length>0&&this.targets.toArray().forEach(function(s){var d=a(s),f=c.tip||void 0,q,p,o,n,m,l,r,g,j,i,h,e,k;d.data('tm-has-tm-tip')===void 0&&(r=d.attr('data-tm-tooltip-swatch'),q=d.attr('data-tm-tooltip-swatch-desc'),p=d.attr('data-tm-tooltip-swatch-lbl-desc'),o=d.attr('data-tm-tooltip-swatch-img'),n=d.attr('data-tm-tooltip-swatch-img-lbl'),m=d.attr('data-tm-tooltip-swatch-img-desc'),l=d.attr('data-tm-tooltip-swatch-img-lbl-desc'),d.data('tm-has-tm-tip',1),d.attr('data-original')!==void 0?h=d.attr('data-original'):d.attr('src')!==void 0?d.attr('data-src')!==void 0?h=d.attr('data-src'):h=d.attr('src'):h=d[0].src,g=d.closest('.tmcp-field-wrap'),g.is('.tc-epo-element-product-holder')&&(g=d.closest('.cpf-element')),g.length===0&&(g=d.closest('.cpf-element')),g.length===0&&(g=d.closest('.cpf-section').find('.tc-section-inner-wrap .tm-section-description.tm-description')),e=g.find('.tm-tip-html'),e.length===0&&(e=g.find('.checkbox-image-label,.checkbox-image-label-inline,.radio-image-label,.radio-image-label-inline')),e.length===0&&(e=g.next('.checkbox-image-label,.checkbox-image-label-inline,.radio-image-label,.radio-image-label-inline,.tm-tip-html')),e.length===0&&g.is('.tm-description')&&(e=g),g=e,e=a(g),k=d.attr('data-tm-hide-label')==='yes'||d.attr('data-tm-hide-label')===void 0||e.is('.tm-tip-html'),i='',j=d.closest('.tmcp-field-wrap'),j=j.find('[data-tm-tooltip-html]'),j.length===0?(j=d.closest('.tmcp-field-wrap').find('.tc-inline-description'),j.length>0&&(i=j.html())):i=j.attr('data-tm-tooltip-html'),f===void 0?(r?f=e.html():q&&i!==''?f='<aside>'+i+'</aside>':p&&(e.html()!==''||i!=='')?f='<aside>'+e.html()+'</aside><aside>'+i+'</aside>':o&&h!==''?f='<img src="'+h+'">':n&&(e.html()!==''||h!=='')?f='<img src="'+h+'"><aside>'+e.html()+'</aside>':m&&(h!==''||i!=='')?f='<img src="'+h+'"><aside>'+i+'</aside>':l&&(e.html()!==''||h!==''||i!=='')&&(f='<img src="'+h+'"><aside>'+e.html()+'</aside><aside>'+i+'</aside>'),f!==void 0&&(d.data('tm-tip-html',f),k&&e.hide()),d.attr('data-tm-tooltip-html')?f=d.attr('data-tm-tooltip-html'):f=d.attr('title')):d.data('tm-tip-html',f),d.on('tc-tooltip-html-changed',function(){d.attr('data-tm-tooltip-html')?d.show():d.hide()}),d.closest('label').on('mouseenter tmshowtooltip',b.show.bind(b,d)),d.on('mouseenter.tc tmshowtooltip.tc',b.show.bind(b,d)),c.trigger&&b.show(d))})}},a.fn.tcToolTip=function(c){var e=a(this),i=e.map(function(){return a(this).data('tctooltip')||''}).get().some(function(a){return a===''}),b,g,h,f;return typeof c=='object'?g=c:g={},i&&(b=new d(this,g),e.data('tctooltip',b)),typeof c=='string'&&(b=e.data('tctooltip'),f=b[c].apply(b,[])),f===void 0?h=e:h=f,h},a.fn.tcToolTip.defaults={fadin:'fadein',fadeout:'fadeout',speed:1500},a.fn.tcToolTip.instances=[],a.fn.tcToolTip.Constructor=d,a.tcToolTip=function(b,f){var c=!1,e;return b=b||a('.tm-tooltip'),e=b.map(function(){return a(this).data('tctooltip')||''}).get().some(function(a){return a===''}),e&&(c=new d(b,f),b.data('tctooltip',c)),c}})(window,window.jQuery)