(function(a,c,e){'use strict';var b=function(b,c,d,e,f){var a=this;a.field=c,a.currentCart=d,a.variableProductContainers=e,a.epoObject=f,a.$form=b,a.$wrap=b.closest('.tc-epo-element-product-container-wrap'),a.$attributeFields=b.find('.tc-epo-variable-product-selector'),a.$singleVariation=b.find('.tc-epo-element-single-variation'),a.$resetVariations=b.find('.tc-epo-element-variable-reset-variations'),a.variationData=b.data('product_variations'),a.useAjax=!1===a.variationData,a.xhr=!1,a.loading=!0,a.variationId=b.closest('.tc-epo-element-product-li-container').find('.tc-epo-element-product-container-variation-id input.product-variation-id'),a.getChosenAttributes=a.getChosenAttributes.bind(a),a.findMatchingVariations=a.findMatchingVariations.bind(a),a.isMatch=a.isMatch.bind(a),a.toggleResetLink=a.toggleResetLink.bind(a),b.on('click.tc-variation-form','.tc-epo-element-variable-reset-variations',{variationForm:a},a.onReset),b.on('tc_hide_variation',{variationForm:a},a.onHide),b.on('tc_show_variation',{variationForm:a},a.onShow),b.on('tc_reset_data',{variationForm:a},a.onResetDisplayedVariation),b.on('tc_reset_image',{variationForm:a},a.onResetImage),b.on('change.tc-variation-form','.tc-epo-variable-product-selector',{variationForm:a},a.onChange),b.on('tc_found_variation.tc-variation-form',{variationForm:a},a.onFoundVariation),b.on('tc_check_variations.tc-variation-form',{variationForm:a},a.onFindVariation),b.on('tc_update_variation_values.tc-variation-form',{variationForm:a},a.onUpdateAttributes),b.on('refresh.tc-variation-form',{variationForm:a},a.onRefreshContainer),b.on('update_field.tc-variation-form',{variationForm:a},a.onUpdateField),a.variationId.val(''),setTimeout(function(){b.trigger('refresh'),b.trigger('tc_variation_form'),a.loading=!1},100)};b.prototype.onRefreshContainer=function(b){var a=b.data.variationForm;a.variableProductContainers.find('.tc-epo-element-product-container').removeClass('variations_form'),a.$form.addClass('variations_form'),a.$form.trigger('tc_check_variations.tc-variation-form')},b.prototype.onUpdateField=function(d,i){var c=d.data.variationForm,b,a,f,g,e,h;d.preventDefault(),i||(b=c.field,a=b,b.is('select')&&(a=b.find('option:selected')),f=0,g=0,e=0,h=0,b.data('price_set',1),a.data('associated_price_set',1),a.data('price_set',1),a.data('raw_price',g),a.data('raw_original_price',h),a.data('price',f),a.data('original_price',e),b.data('price-changed',1),c.$form.trigger({type:'tm-epo-update',norules:2}),c.currentCart.trigger({type:'tm-epo-update',norules:2}))},b.prototype.onReset=function(a){a.preventDefault(),a.data.variationForm.$attributeFields.val('').trigger('change'),a.data.variationForm.$form.trigger('tc_reset_data')},b.prototype.onHide=function(a){a.preventDefault()},b.prototype.onShow=function(a){a.preventDefault()},b.prototype.onResetDisplayedVariation=function(b){var a=b.data.variationForm;a.$form.find('.product-meta').find('.tc-product-sku').tc_reset_content(),a.$form.trigger('tc_reset_image'),a.$singleVariation.slideUp(200).trigger('tc_hide_variation')},b.prototype.onResetImage=function(a){a.data.variationForm.$form.tc_variations_image_update(!1)},b.prototype.onFindVariation=function(h){var b=h.data.variationForm,c=b.getChosenAttributes(),d=c.data,e,g,f;if(c.count===c.chosenCount)if(b.useAjax){if(typeof wc_add_to_cart_variation_params=='undefined')return;b.xhr&&b.xhr.abort(),e=b.$form.closest('.cpf-type-product'),b.$form.block({message:null,overlayCSS:{background:'#fff',opacity:.6}}),d.product_id=parseInt(b.$form.data('product_id'),10),d.discount=e.attr('data-discount'),d.discount_type=e.attr('data-discount-type'),d.discount_exclude_addons=e.attr('data-discount-exclude-addons'),b.xhr=a.ajax({url:wc_add_to_cart_variation_params.wc_ajax_url.toString().replace('%%endpoint%%','get_variation'),type:'POST',data:d,success:function(a){a?b.$form.trigger('tc_found_variation',[a]):(b.$form.trigger('tc_reset_data'),c.chosenCount=0,b.loading||(b.$form.find('.tc-epo-element-single-variation').after('<p class="wc-no-matching-variations woocommerce-info">'+wc_add_to_cart_variation_params.i18n_no_matching_variations_text+'</p>'),b.$form.find('.wc-no-matching-variations').slideDown(200),b.$form.trigger('update_field',[])))},complete:function(){b.$form.unblock()}})}else b.$form.trigger('tc_update_variation_values'),g=b.findMatchingVariations(b.variationData,d),f=g.shift(),f?b.$form.trigger('tc_found_variation',[f]):(b.$form.trigger('tc_reset_data'),c.chosenCount=0,b.loading||(b.$form.find('.tc-epo-element-single-variation').after('<p class="wc-no-matching-variations woocommerce-info">'+wc_add_to_cart_variation_params.i18n_no_matching_variations_text+'</p>'),b.$form.find('.wc-no-matching-variations').slideDown(200)));else b.variationId.val('').trigger('change'),b.$form.trigger('update_field',[]),b.$form.trigger('tc_update_variation_values'),b.$form.trigger('tc_reset_data');b.toggleResetLink(c.chosenCount>0)},b.prototype.onFoundVariation=function(m,b){var e=m.data.variationForm,l=e.$form.find('.product-meta').find('.tc-product-sku'),i=e.$wrap.find('.tm-quantity-alt'),c=i.find('input.tm-qty-alt'),f=a.epoAPI.math.toInt(c.attr('data-min')),g=a.epoAPI.math.toInt(c.attr('data-max')),n=c.attr('data-max'),j=!0,k=!1,h='';b.sku?l.tc_set_content(b.sku):l.tc_reset_content(),e.$form.tc_variations_image_update(b),b.variation_is_visible?k=d('variation-template'):k=d('unavailable-variation-template'),e.field.attr('data-no-price')&&(b.display_price='',b.display_regular_price='',b.price_html=''),e.$form.find('.tc-epo-element-product-container-cart').find('.stock').remove(),h=k({variation:b}),h=h.replace('/*<![CDATA[*/',''),h=h.replace('/*]]>*/',''),e.$singleVariation.html(h),e.variationId.val(b.variation_id).trigger('change'),b.is_sold_individually==='yes'?(c.val('1').attr('min','1').attr('max','1'),i.hide()):(b.min_qty!==''&&b.min_qty>f&&f>0&&(f=b.min_qty),b.max_qty!==''&&b.max_qty<g&&(g=b.max_qty),f!==''?c.attr('min',f):c.removeAttr('min'),n!==''?c.attr('max',g):c.removeAttr('max'),g&&a.epoAPI.math.toInt(c.val())>g&&c.val(g),f>a.epoAPI.math.toInt(c.val())&&c.val(f),i.show()),(!b.is_purchasable||!b.is_in_stock||!b.variation_is_visible)&&(j=!1,c.val('0').attr('min','0').attr('max','0'),i.hide()),c.trigger('change'),a.epoAPI.util.trim(e.$singleVariation.text())?e.$singleVariation.slideDown(200).trigger('tc_show_variation',[b,j]):e.$singleVariation.show().trigger('tc_show_variation',[b,j]),e.$form.trigger('update_field',[b])},b.prototype.onChange=function(b){var a=b.data.variationForm,c=a.field;a.variationId.val('').trigger('change'),a.$form.find('.wc-no-matching-variations').remove(),a.useAjax?a.$form.trigger('tc_check_variations'):(a.$form.trigger('woocommerce_variation_select_change'),a.$form.trigger('tc_check_variations')),a.$form.trigger('woocommerce_variation_has_changed'),setTimeout(function(){c.closest('.tcowl-carousel').trigger('refresh.owl.carousel')},50)},b.prototype.onUpdateAttributes=function(c){var b=c.data.variationForm,d=b.getChosenAttributes(),e=d.data;if(b.useAjax)return;b.$attributeFields.each(function(z,x){var c=a(x),w=c.data('attribute_name')||c.attr('name'),y=a(x).data('show_option_none'),k=':gt(0)',s=0,d=a('<select/>'),g=c.val()||'',m=!0,n,r,f,o,j,v,q,i,h,l,p,t,u;c.data('attribute_html')||(n=c.clone(),n.find('option').prop('disabled',!1).prop('selected',!1).removeAttr('attached'),c.data('attribute_options',n.find('option'+k).get()),c.data('attribute_html',n.html())),d.html(c.data('attribute_html')),r=a.extend(!0,{},e),r[w]='',f=b.findMatchingVariations(b.variationData,r);for(o in f)if(typeof f[o]!='undefined'){q=f[o].attributes;for(i in q)if(Object.prototype.hasOwnProperty.call(q,i))if(h=q[i],l='',i===w)if(f[o].variation_is_active&&(l='enabled'),h){if(h=a('<div/>').html(h).text(),p=d.find('option'),p.length)for(j=0,v=p.length;j<v;j++)if(t=a(p[j]),u=t.val(),h===u){t.addClass('attached '+l);break}}else d.find('option:gt(0)').addClass('attached '+l)}s=d.find('option.attached').length,g&&(m=!1,0!==s&&d.find('option.attached.enabled').each(function(){var b=a(this).val();if(g===b)return m=!0,!1})),s>0&&g&&m&&'no'===y&&(d.find('option:first').remove(),k=''),d.find('option'+k+':not(.attached)').remove(),c.html(d.html()),c.find('option'+k+':not(.enabled)').prop('disabled',!0),g?m?c.val(g):c.val('').trigger('change'):c.val('')}),b.$form.trigger('woocommerce_update_variation_values')},b.prototype.getChosenAttributes=function(){var b={},c=0,d=0;return this.$attributeFields.each(function(){var f=a(this).data('attribute_name')||a(this).attr('name'),e=a(this).val()||'';e.length>0&&d++,c++,b[f]=e}),{count:c,chosenCount:d,data:b}},b.prototype.findMatchingVariations=function(c,e){var d=[],a,b;for(a=0;a<c.length;a++)b=c[a],this.isMatch(b.attributes,e)&&d.push(b);return d},b.prototype.isMatch=function(d,f){var e=!0,a,b,c;for(c in d)Object.prototype.hasOwnProperty.call(d,c)&&(a=d[c],b=f[c],a!==void 0&&b!==void 0&&a.length!==0&&b.length!==0&&a!==b&&(e=!1));return e},b.prototype.toggleResetLink=function(a){a?this.$resetVariations.css('visibility')==='hidden'&&this.$resetVariations.css('visibility','visible').hide().fadeIn():this.$resetVariations.css('visibility','hidden')},a.fn.tc_product_variation_form=function(a,c,d,e){return new b(this,a,c,d,e),this.trigger('tc_product_variation_form'),this},a.fn.tc_set_content=function(a){void 0===this.attr('data-o_content')&&this.attr('data-o_content',this.text()),this.text(a)},a.fn.tc_reset_content=function(){void 0!==this.attr('data-o_content')&&this.text(this.attr('data-o_content'))},a.fn.tc_set_variation_attr=function(a,b){void 0===this.attr('data-o_'+a)&&this.attr('data-o_'+a,this.attr(a)?this.attr(a):''),!1===b?this.removeAttr(a):this.attr(a,b)},a.fn.tc_reset_variation_attr=function(a){void 0!==this.attr('data-o_'+a)&&this.attr(a,this.attr('data-o_'+a))},a.fn.tc_variations_image_update=function(a){var d=this,c=d.find('.tc-product-image, .woocommerce-product-gallery__image, .woocommerce-product-gallery__image--placeholder').eq(0),b=c.find('.wp-post-image'),e=c.find('a').eq(0);a&&a.image&&a.image.src&&a.image.src.length>1?(b.tc_set_variation_attr('src',a.image.src),b.tc_set_variation_attr('height',a.image.src_h),b.tc_set_variation_attr('width',a.image.src_w),b.tc_set_variation_attr('srcset',a.image.srcset),b.tc_set_variation_attr('sizes',a.image.sizes),b.tc_set_variation_attr('title',a.image.title),b.tc_set_variation_attr('data-caption',a.image.caption),b.tc_set_variation_attr('alt',a.image.alt),b.tc_set_variation_attr('data-src',a.image.full_src),b.tc_set_variation_attr('data-large_image',a.image.full_src),b.tc_set_variation_attr('data-large_image_width',a.image.full_src_w),b.tc_set_variation_attr('data-large_image_height',a.image.full_src_h),c.tc_set_variation_attr('data-thumb',a.image.src),e.tc_set_variation_attr('href',a.image.full_src)):d.tc_variations_image_reset()},a.fn.tc_variations_image_reset=function(){var c=this,b=c.find('.tc-product-image, .woocommerce-product-gallery__image, .woocommerce-product-gallery__image--placeholder').eq(0),a=b.find('.wp-post-image'),d=b.find('a').eq(0);a.tc_reset_variation_attr('src'),a.tc_reset_variation_attr('width'),a.tc_reset_variation_attr('height'),a.tc_reset_variation_attr('srcset'),a.tc_reset_variation_attr('sizes'),a.tc_reset_variation_attr('title'),a.tc_reset_variation_attr('data-caption'),a.tc_reset_variation_attr('alt'),a.tc_reset_variation_attr('data-src'),a.tc_reset_variation_attr('data-large_image'),a.tc_reset_variation_attr('data-large_image_width'),a.tc_reset_variation_attr('data-large_image_height'),b.tc_reset_variation_attr('data-thumb'),d.tc_reset_variation_attr('href')};function d(d){var b=e.getElementById('tmpl-'+d).textContent,a=!1;return a=a||/<#\s?data\./.test(b),a=a||/{{{?\s?data\.(?!variation\.).+}}}?/.test(b),a=a||/{{{?\s?data\.variation\.[\w-]*[^\s}]/.test(b),a?c.wp.template(d):function(d){var e=d.variation||{},a;return b.replace(/({{{?)\s?data\.variation\.([\w-]*)\s?(}}}?)/g,function(g,b,d,f){return b.length!==f.length?'':(a=e[d]||'',b.length===2)?c.escape(a):a})}}})(window.jQuery,window,document)