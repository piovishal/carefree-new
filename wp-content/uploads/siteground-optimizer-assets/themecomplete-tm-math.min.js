(function(e){'use strict';var h=function(a){var e=[f,null,!1,0,'','0'],c,b,d,f;for(b=0,d=e.length;b<d;b++)if(a===e[b])return!0;if(typeof a=='object'){for(c in a)if(a.hasOwnProperty(c))return!1;return!0}return!1},f=function(b,a){return!(!a||a.constructor!==Array&&a.constructor!==Object)&&b in a},n=function(a){const b=!0,c=b?/^(function)?\s*[^\(]*\(\s*([^\)]*)\)/m:/^(function)\s*[^\(]*\(\s*([^\)]*)\)/m,d=/,/,e=/^\s*(_?)(.+?)\1\s*$/,f=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg;return((a||'').toString().replace(f,'').match(c)||['','',''])[2].split(d).map(function(a){return a.replace(e,function(b,c,a){return a.split('=')[0].trim()})}).filter(String).length},w=function(a){return a.length},k=function(a){return/boolean|number|string/.test(typeof a)},g=function(a){return{}.toString.call(a).split(' ')[1].slice(0,-1).toLowerCase()},b=function(a,b){var c;return!(typeof a=='string'||typeof a=='number')||isNaN(a)?b!==void 0?b:0:(c=parseFloat(a),isNaN(c))?b!==void 0?b:a:c},j=function(a,b){return a===b?0:a>b?1:-1},v=function(a){return a=(a+'').replace(/[^01]/gi,''),parseInt(a,2)},u=function(a){return a<0&&(a=4294967295+a+1),parseInt(a,10).toString(2)},l=function(a){return a<0&&(a=4294967295+a+1),parseInt(a,10).toString(16)},m=function(a){return a<0&&(a=4294967295+a+1),parseInt(a,10).toString(8)},z=function(a){return a*.017453292519943295},o=function(b,a=0){var c=b>=0?1:-1;return a===0?Math.round(b):parseFloat((Math.round(b*Math.pow(10,a)+c*1e-4)/Math.pow(10,a)).toFixed(a))},p=function(a){return a=(a+'').replace(/[^a-f0-9]/gi,''),parseInt(a,16)},q=function(a){return a=(a+'').replace(/[^0-7]/gi,''),parseInt(a,8)},r=function(a,c){var b;return a=Math.abs(a),c=Math.abs(c),b=Math.min(a,c),a=Math.max(a,c),b=b/a,a*Math.sqrt(1+b*b)||null},s={variables:{},on_var_not_found:void 0,on_var_validation:void 0,operators:{},functions:{},cache:{},construct:function(){return this.add_defaults(),this.set_division_by_zero_to_zero(),this},add_operator:function(a){return this.operators[a.operator]=a,this},evaluate:function(a,b=!0){return this.execute(a,b)},execute:function(d,h=!0){var c=d,e,a,b;return f(c,this.cache)?a=this.cache[c]:(a=new t(d,this.operators),a=a.tokenize().build_reverse_polish_notation(),h&&(this.cache[c]=a)),e=new y(this.functions,this.operators),b=e.calculate(a,this.variables,this.on_var_not_found,this),('number'!==g(b)||isNaN(b))&&(b=0),b},add_function:function(a,b){return this.functions[a]=new x(a,b),this},get_vars:function(){return this.variables},get_var:function(a){return f(a,this.variables)?this.variables[a]:(this.on_var_not_found&&'function'==typeof this.on_var_not_found&&this.on_var_not_found(a),d.trigger('Variable ('+a+') not set','UnknownVariableError',0))},set_var:function(b,a){return this.on_var_validation&&'function'==typeof this.on_var_validation&&(a=this.on_var_validation(b,a)),this.variables[b]=a,this},var_exists:function(a){return f(a,this.variables)},set_vars:function(a,b=!0){var c=this;return b&&this.remove_vars(),a.forFach(function(a,b){c.set_var(b,a)}),this},set_var_not_found_handler:function(a){return this.on_var_not_found=a,this},set_var_validation_handler:function(a){return this.on_var_validation=a,this},remove_var:function(a){return delete this.variables[a],this},remove_vars:function(){return this.variables={},this.on_var_not_found=null,this},get_operators:function(){return this.operators},get_functions:function(){return this.functions},remove_operator:function(a){delete this.operators[a]},set_division_by_zero_to_zero:function(){return this.add_operator(new i('/',!1,180,function(b,a){return b=Number(b),a=Number(a),0==a?0:b/a})),this},get_cache:function(){return this.cache},clear_cache:function(){this.cache=[]},add_defaults:function(){var a=this,b=this.default_operators(),c=this.default_functions();return Object.keys(b).forEach(function(d){var c=b[d];a.add_operator(new i(d,c[2],c[1],c[0]))}),Object.keys(c).forEach(function(b){var d=c[b];a.add_function(b,d)}),this.on_var_validation=this.default_var_validation,this.variables=this.default_vars(),this},default_operators:function(){return{'+':[function(a,c){return a=b(a,0),c=b(c,0),a+c},170,!1],'-':[function(a,c){return a=b(a,0),c=b(c,0),a-c},170,!1],uPos:[function(a){return a=b(a,0),a},200,!1],uNeg:[function(a){return a=b(a,0),0-a},200,!1],'*':[function(a,c){return a=b(a,0),c=b(c,0),a*c},180,!1],'/':[function(c,a){return c=b(c,0),a=b(a,0),h(a)?d.trigger('Division By Zero','DivisionByZeroError',0):c/a},180,!1],'^':[function(a,c){return a=b(a,0),c=b(c,0),Math.pow(a,c)},220,!0],'%':[function(a,c){return a=b(a,0),c=b(c,0),a%c},180,!1],'&&':[function(a,c){return a=String(a),c=String(c),a.isNumeric()&&(a=b(a,0)),c.isNumeric()&&(c=b(c,0)),a&&c?1:0},100,!1],'||':[function(a,c){return a=String(a),c=String(c),a.isNumeric()&&(a=b(a,0)),c.isNumeric()&&(c=b(c,0)),a||c?1:0},90,!1],'==':[function(a,c){return a=String(a),c=String(c),a.isNumeric()&&c.isNumeric()?b(a)===b(c)?1:0:0===j(a,c)?1:0},140,!1],'!=':[function(a,c){return a=String(a),c=String(c),a.isNumeric()&&c.isNumeric()?b(a)!==b(c)?1:0:0===j(a,c)?1:0},140,!1],'>=':[function(a,c){return a=String(a),c=String(c),a.isNumeric()&&(a=b(a,0)),c.isNumeric()&&(c=b(c,0)),a>=c?1:0},150,!1],'>':[function(a,c){return a=String(a),c=String(c),a.isNumeric()&&(a=b(a,0)),c.isNumeric()&&(c=b(c,0)),a>c?1:0},150,!1],'<=':[function(a,c){return a=String(a),c=String(c),a.isNumeric()&&(a=b(a,0)),c.isNumeric()&&(c=b(c,0)),a<=c?1:0},150,!1],'<':[function(a,c){return a=String(a),c=String(c),a.isNumeric()&&(a=b(a,0)),c.isNumeric()&&(c=b(c,0)),a<c?1:0},150,!1]}},default_functions:function(){var a=this;return{abs:Math.abs,acos:Math.acos,acosh:Math.acosh,arcsin:Math.asin,arcctg:function(a){return Math.PI/2-Math.atan(a)},arccot:function(a){return Math.PI/2-Math.atan(a)},arccotan:function(a){return Math.PI/2-Math.atan(a)},arcsec:function(a){return Math.acos(1/a)},arccosec:function(a){return Math.asin(1/a)},arccsc:function(a){return Math.asin(1/a)},arccos:Math.acos,arctan:Math.atan,arctg:Math.atan,array:function(...a){return a},asin:Math.asin,atan:Math.atan,atan2:Math.atan2,atanh:Math.atanh,atn:Math.atan,avg:function(c,...a){var e;if(Array.isArray(c))if(0===c.length)return d.trigger('Array must contain at least one element!','InvalidArgumentError',0);return a=[].concat.apply([],[c,...a]),e=a.reduce(function(a,c){return b(c,0)+b(a,0)}),e/a.length},average:function(c,...a){var e;if(Array.isArray(c))if(0===c.length)return d.trigger('Array must contain at least one element!','InvalidArgumentError',0);return a=[].concat.apply([],[c,...a]),e=a.reduce(function(a,c){return b(c,0)+b(a,0)}),e/a.length},bindec:v,ceil:Math.ceil,cos:Math.cos,cosec:function(a){return Math.sin(1/a)},csc:function(a){return Math.sin(1/a)},cosh:Math.cosh,ctg:function(a){return Math.cos(a)/Math.sin(a)},cot:function(a){return Math.cos(a)/Math.sin(a)},cotan:function(a){return Math.cos(a)/Math.sin(a)},cotg:function(a){return Math.cos(a)/Math.sin(a)},ctn:function(a){return Math.cos(a)/Math.sin(a)},decbin:u,dechex:l,decoct:m,deg2rad:z,exp:Math.exp,expm1:Math.expm1,floor:Math.floor,int:Math.floor,fmod:function(a,b){return a%b},hexdec:p,hypot:r,if:function(b,d,e){var c;return 0===b||1===b||!0===b||!1===b?c=b:c=a.execute(b),c?a.execute(d):a.execute(e)},intdiv:function(a,b){return Math.trunc(Math.trunc(a)/Math.trunc(b))},ln:Math.log,lg:Math.log10,log:Math.log,log1p:Math.log1p,max:function(a,...e){var c;return Array.isArray(a)&&0===a.length?d.trigger('Array must contain at least one element!','InvalidArgumentError',0):(c=Array.isArray(a)?a:[a,...e],c=c.map(b),Math.max(...c))},min:function(a,...e){var c;return Array.isArray(a)&&0===a.length?d.trigger('Array must contain at least one element!','InvalidArgumentError',0):(c=Array.isArray(a)?a:[a,...e],c=c.map(b),Math.min(...c))},octdec:q,pi:function(){return Math.PI},pow:Math.pow,rad2deg:function(a){return a*57.29577951308232},round:o,sin:Math.sin,sinh:Math.sinh,sec:function(a){return 1/Math.cos(a)},sqrt:Math.sqrt,tan:Math.tan,tanh:Math.tanh,tn:Math.tan,tg:Math.tan,lookuptable:function(k,i){var l=0,j=0,n=e.TMEPOJS,c,d,m,f,g;if(n)if(m=e&&e.jQuery&&e.jQuery.epoAPI&&e.jQuery.epoAPI.util.parseJSON(n.lookupTables),m){if(Array.isArray(i)&&(j=i[1],i=i[0]),h(i))return 0;h(j)&&(j=0),Array.isArray(k)?(f=k[0],g=k[1]):(f=k,g=''),c=m[i],c&&(c=c[j],c&&(c=c.data,d=c[f],d===void 0&&f&&f!==void 0&&(b(f)===0?d=c[Object.keys(c)[0]]:f&&(f=a.find_lookup_table_index(f,c),d=c[f])),d!==void 0&&(g&&g!==void 0?g=a.find_lookup_table_index(g,d):g=Object.keys(d)[0],g==='max'?l=b(d[Object.keys(d)[Object.keys(d).length-1]]):l=b(d[g]))))}return l},concat:function(a,...c){var b;return Array.isArray(a)&&0===a.length?d.trigger('Array must contain at least one element!','InvalidArgumentError',0):(b=Array.isArray(a)?a:[a,...c],b.join(''))}}},find_lookup_table_index:function(a,e){var c=Object.keys(e),d;return!(a=b(a),d=c.map(function(a){return a==='max'?a:b(a)}).reduce(function(c,b){if(b==='max'&&a>c)return b;if(c==='max'&&a>b)return c;if(c<b){if(a>c&&a<=b)return b}else return a>b&&a<=c||a>c||b==='max'?c:b;return a>b?b:c}),c=c.map(function(a){return a==='max'?a:b(a)}),a>Math.max(...c)||a<Math.min(...c))&&d},default_vars:function(){return{pi:3.141592653589793,e:2.718281828459045}},default_var_validation:function(b,a){return!k(a)&&!Array.isArray(a)&&void 0!==a?d.trigger('Variable ('+b+') type ('+g(a)+') is not scalar or array!',0):a}},t=function(e,g){var b={tokens:[],input:'',operators:{},number_buffer:'',string_buffer:'',allow_negative:!0,in_single_quoted_string:!1,in_double_quoted_string:!1,is_number:function(a){return a>='0'&&a<='9'},is_alpha:function(a){return a>='a'&&a<='z'||a>='A'&&a<='Z'||'_'===a},is_dot:function(a){return'.'===a},is_lp:function(a){return'('===a},is_rp:function(a){return')'===a},is_comma:function(a){return','===a},empty_number_buffer_as_literal:function(){this.number_buffer.length&&(this.tokens.push(c(a.LITERAL,this.number_buffer)),this.number_buffer='')},empty_str_buffer_as_variable:function(){''!==this.string_buffer&&(this.tokens.push(c(a.VARIABLE,this.string_buffer)),this.string_buffer='')},tokenize:function(){var d=!1,b=this,e=[];return this.tokens=[],this.input.toString().split('').forEach(function(e){switch(!0){case b.in_single_quoted_string:if('\\'===e){d?(b.string_buffer+='\\',d=!1):d=!0;break}if("'"===e){d?(b.string_buffer+="'",d=!1):(b.tokens.push(c(a.STRING,b.string_buffer)),b.in_single_quoted_string=!1,b.string_buffer='');break}d&&(b.string_buffer+='\\',d=!1),b.string_buffer+=e;break;case b.in_double_quoted_string:if('\\'===e){d?(b.string_buffer+='\\',d=!1):d=!0;break}if('"'===e){d?(b.string_buffer+='"',d=!1):(b.tokens.push(c(a.STRING,b.string_buffer)),b.in_double_quoted_string=!1,b.string_buffer='');break}d&&(b.string_buffer+='\\',d=!1),b.string_buffer+=e;break;case'['===e:b.tokens.push(c(a.FUNCTION,'array')),b.allow_negative=!0,b.tokens.push(c(a.LEFTPARENTHESIS,''));break;case' '===e||'\n'===e||'\r'===e||'	'===e:break;case b.is_number(e):if(''!==b.string_buffer){b.string_buffer+=e;break}b.number_buffer+=e,b.allow_negative=!1;break;case'e'===e.toLowerCase():if(b.number_buffer.length&&-1!==b.number_buffer.indexOf('.')){b.number_buffer+='e',b.allow_negative=!1;break}case b.is_alpha(e):b.number_buffer.length&&(b.empty_number_buffer_as_literal(),b.tokens.push(c(a.OPERATOR,'*'))),b.allow_negative=!1,b.string_buffer+=e;break;case'"'===e:b.in_double_quoted_string=!0;break;case"'"===e:b.in_single_quoted_string=!0;break;case b.is_dot(e):b.number_buffer+=e,b.allow_negative=!1;break;case b.is_lp(e):''!==b.string_buffer?(b.tokens.push(c(a.FUNCTION,b.string_buffer)),b.string_buffer=''):b.number_buffer.length&&(b.empty_number_buffer_as_literal(),b.tokens.push(c(a.OPERATOR,'*'))),b.allow_negative=!0,b.tokens.push(c(a.LEFTPARENTHESIS,e));break;case b.is_rp(e)||']'===e:b.empty_number_buffer_as_literal(),b.empty_str_buffer_as_variable(),b.allow_negative=!1,b.tokens.push(c(a.RIGHTPARENTHESIS,e));break;case b.is_comma(e):b.empty_number_buffer_as_literal(),b.empty_str_buffer_as_variable(),b.allow_negative=!0,b.tokens.push(c(a.PARAMSEPARATOR,e));break;default:if('-'===e||'+'===e){if(b.allow_negative){b.allow_negative=!1,b.tokens.push(c(a.OPERATOR,'-'===e?'uNeg':'uPos'));break}if(b.number_buffer&&'e'===b.number_buffer[b.number_buffer.length-1]){b.number_buffer+=e;break}}b.empty_number_buffer_as_literal(),b.empty_str_buffer_as_variable(),'$'!==e&&(b.tokens.length>0?a.OPERATOR===b.tokens[b.tokens.length-1].type?b.tokens[b.tokens.length-1].value+=e:b.tokens.push(c(a.OPERATOR,e)):b.tokens.push(c(a.OPERATOR,e))),b.allow_negative=!0}}),this.empty_number_buffer_as_literal(),this.empty_str_buffer_as_variable(),this.tokens.forEach(function(a,b){e[b]=a.type}),e.forEach(function(f,d){d>0&&'space'===f&&'variable'===e[d+1]&&'variable'===e[d-1]&&(b.tokens[d]=new c(a.LITERAL,0),b.tokens.splice(d+1,1),b.tokens.splice(d-1,1))}),this},build_reverse_polish_notation:function(){var c=[],b=[],e=[],g=this,i,j,k,h;try{this.tokens.forEach(function(l){switch(l.type){case a.LITERAL:case a.VARIABLE:case a.STRING:c.push(l),e.length>0&&0===e[e.length-1]&&e.push(e.pop()+1);break;case a.FUNCTION:e.length>0&&0===e[e.length-1]&&e.push(e.pop()+1),b.push(l),e.push(0);break;case a.LEFTPARENTHESIS:b.push(l);break;case a.PARAMSEPARATOR:while(a.LEFTPARENTHESIS!==b[b.length-1].type){if(0===b.length)return d.trigger('Incorrect Brackets','IncorrectBracketsError',c);c.push(b.pop())}e.push(e.pop()+1);break;case a.OPERATOR:if(!f(l.value,g.operators))return d.trigger(l.value,'UnknownOperatorError',c);for(j=g.operators[l.value];b.length>0&&a.OPERATOR===b[b.length-1].type;){if(!f(b[b.length-1].value,g.operators))return d.trigger(b[b.length-1].value,'UnknownOperatorError',c);if(k=g.operators[b[b.length-1].value],k.priority>=j.priority){c.push(b.pop());continue}break}b.push(l);break;case a.RIGHTPARENTHESIS:while(!0)try{if(h=b.pop(),a.LEFTPARENTHESIS===h.type)break;c.push(h)}catch(a){return d.trigger('Incorrect Brackets','IncorrectBracketsError',c)}b.length>0&&a.FUNCTION===b[b.length-1].type&&(i=b.pop(),i.param_count=e.pop(),c.push(i));break;case a.SPACE:}})}catch(a){return c=[],d.trigger(a,'Error',c)}while(0!==b.length){if(a.LEFTPARENTHESIS===b[b.length-1].type||a.RIGHTPARENTHESIS===b[b.length-1].type)return d.trigger('Incorrect Brackets','IncorrectBracketsError',c);if(a.SPACE===b[b.length-1].type){b.pop();continue}c.push(b.pop())}return c}};return b.input=e,b.operators=g,b},a={LITERAL:'literal',VARIABLE:'variable',OPERATOR:'operator',LEFTPARENTHESIS:'LP',RIGHTPARENTHESIS:'RP',FUNCTION:'function',PARAMSEPARATOR:'separator',STRING:'string',SPACE:'space'},c=function(c,d,e){var b={type:a.LITERAL,value:void 0,name:void 0,param_count:null};return b.type=c,b.value=d,b.name=e,b},i=function(f,h,i,e){var b={operator:'',is_right_assoc:!1,priority:0,function:null,places:0};return b.operator=f,b.is_right_assoc=h,b.priority=i,b.function=e,b.places=n(e),b.execute=function(e){var h=[],f,b;if(e.length<this.places)return e.splice(0,e.length),d.trigger('Incorrect Expression','IncorrectExpressionError',new c(a.LITERAL,0));for(f=0;f<this.places;f++)h.unshift(e.pop().value);return b=this.function.apply(null,h),'number'!==g(b)&&'string'!==g(b)&&(b=0),new c(a.LITERAL,b)},b},x=function(f,e){var b={name:'',function:void 0,required_param_count:void 0};return b.name=f,b.function=e,b.required_param_count=w(e),b.execute=function(g,b){var h=[],i,e,f;if(b<this.required_param_count&&(b=this.required_param_count),b<this.required_param_count)return g.splice(0,g.length),d.trigger(this.name,'IncorrectNumberOfFunctionParametersError',new c(a.LITERAL,0));if(b>0)for(i=0;i<b;i++)e=g.length?g.pop().value:0,null===e?(e='0',h.push(e)):h.unshift(e);return f=this.function.apply(null,h),(f===1/0||f===-(1/0))&&(f=0),c(a.LITERAL,f)},b},y=function(j,k){var i={functions:{},operators:{}};return i.functions=j,i.operators=k,i.calculate=function(o,l,m=null,n=!1){var k=this,j=[],i;if(h(o))return 0;try{o.forEach(function(b){var e,g;if(a.LITERAL===b.type||a.STRING===b.type)j.push(b);else if(a.VARIABLE===b.type)e=b.value,g=null,f(e,l)?g=l[e]:m&&'function'==typeof m?g=m(e):(g=e,n.variables[e]=g,l[e]=g),j.push(c(a.LITERAL,g,e));else if(a.FUNCTION===b.type){if(!f(b.value,k.functions)){if(n.add_function(b.value,function(){return 0}),k.functions=n.functions,!f(b.value,k.functions))return d.trigger(b.value,'UnknownFunctionError',0);d.trigger(b.value,'UnknownFunctionError',0)}j.push(k.functions[b.value].execute(j,b.param_count))}else if(a.OPERATOR===b.type){if(!f(b.value,k.operators))return d.trigger(b.value,'UnknownOperatorError',0);j.push(k.operators[b.value].execute(j))}})}catch(a){e.TMEPOJS&&e.TMEPOJS.WP_DEBUG&&e.console.log(a)}return i=j.pop(),null===i||!h(j)?d.trigger('Stack must be empty','IncorrectExpressionError',0):(!1===i.value&&(i.value=0),!0===i.value&&(i.value=1),'string'===g(i.value)&&i.value.isNumeric()&&(i.value=b(i.value)),i.value)},i},d={trigger:function(a,b='',c=!1){return e.TMEPOJS&&e.TMEPOJS.WP_DEBUG&&(e.console.log(b+'\n'+a),e.console.trace()),c}};e.tcmexp=s.construct()})(window)