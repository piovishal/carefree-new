(function(){const a=function(m){var b,e,f,d;const l=document.querySelector('form.wpcf7-form');if(l){const a=new FormData;a.append('action','_wpcf7_check_nonce'),a.append('_ajax_nonce',dnd_cf7_uploader.ajax_nonce),fetch(dnd_cf7_uploader.ajax_url,{method:'POST',body:a}).then(a=>a.json()).then(({data:a,success:b})=>b&&(dnd_cf7_uploader.ajax_nonce=a)).catch(console.error)}b=this;const j={handler:b,color:'#000',background:'',server_max_error:'Uploaded file exceeds the maximum upload size of your server.',max_file:b.dataset.max?b.dataset.max:10,max_upload_size:b.dataset.limit?b.dataset.limit:'10485760',supported_type:b.dataset.type?b.dataset.type:'jpg|jpeg|JPG|png|gif|pdf|doc|docx|ppt|pptx|odt|avi|ogg|m4a|mov|mp3|mp4|mpg|wav|wmv|xls',text:'Drag & Drop Files Here',separator:'or',button_text:'Browse Files',on_success:''},a=Object.assign({},j,m);e=b.dataset.name+'_count_files',localStorage.setItem(e,1);const i=`
            <div class="codedropz-upload-handler">
                <div class="codedropz-upload-container">
                <div class="codedropz-upload-inner">
                    <${dnd_cf7_uploader.drag_n_drop_upload.tag}>${a.text}</${dnd_cf7_uploader.drag_n_drop_upload.tag}>
                    <span>${a.separator}</span>
                    <div class="codedropz-btn-wrap"><a class="cd-upload-btn" href="javascript:void(0)">${a.button_text}</a></div>
                </div>
                </div>
                <span class="dnd-upload-counter"><span>0</span> ${dnd_cf7_uploader.dnd_text_counter} ${parseInt(a.max_file)}</span>
            </div>
        `,h=document.createElement('div');h.classList.add('codedropz-upload-wrapper'),a.handler.parentNode.insertBefore(h,a.handler),h.appendChild(a.handler),a.supported_type=a.supported_type.replace(/[^a-zA-Z0-9| ]/g,"");const g=a.handler.closest('form'),c=a.handler.closest('.codedropz-upload-wrapper'),k=g.querySelector('input[type="submit"]');a.handler.insertAdjacentHTML('afterend',i),['drag','dragstart','dragend','dragover','dragenter','dragleave','drop'].forEach(function(a){c.querySelector('.codedropz-upload-handler').addEventListener(a,function(a){a.preventDefault(),a.stopPropagation()})}),['dragover','dragenter'].forEach(function(a){c.querySelector('.codedropz-upload-handler').addEventListener(a,function(a){c.querySelector('.codedropz-upload-handler').classList.add('codedropz-dragover')})}),['dragleave','dragend','drop'].forEach(function(a){c.querySelector('.codedropz-upload-handler').addEventListener(a,function(a){c.querySelector('.codedropz-upload-handler').classList.remove('codedropz-dragover')})}),c.querySelector('.cd-upload-btn').addEventListener('click',function(b){b.preventDefault(),a.handler.value=null,a.handler.click()}),c.querySelector('.codedropz-upload-handler').addEventListener('drop',function(a){f(a.dataTransfer.files,'drop')}),a.handler.addEventListener('change',function(a){f(this.files,'click')}),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&b.removeAttribute('accept'),f=function(r,s){var f,p,o,l,k,j,i,m,n,h;if(r.length==0)return;f=new FormData,f.append('action','dnd_codedropz_upload'),f.append('type',s),f.append('security',dnd_cf7_uploader.ajax_nonce),f.append('form_id',b.dataset.id),f.append('upload_name',b.dataset.name);const q=a.handler.querySelector('.has-error');q&&q.remove();for(const s of r){if(typeof f.delete!='undefined'&&f.delete('upload-file'),Number(localStorage.getItem(e))>a.max_file)return p=c.querySelector('span.has-error-msg'),p||(o=dnd_cf7_uploader.drag_n_drop_upload.max_file_limit,l=document.createElement('span'),l.className='has-error-msg',l.textContent=o.replace('%count%',a.max_file),c.appendChild(l)),!1;const q=d.createProgressBar(s);if(k=!1,s.size>a.max_upload_size){const b=document.getElementById(q),a=document.createElement('span');a.classList.add('has-error'),a.textContent=dnd_cf7_uploader.drag_n_drop_upload.large_file,b.querySelector('.dnd-upload-details').appendChild(a),k=!0}regex_type=new RegExp("(.*?).("+a.supported_type+")$"),k===!1&&!regex_type.test(s.name.toLowerCase())&&(document.querySelector('#'+q+' .dnd-upload-details').insertAdjacentHTML('beforeend','<span class="has-error">'+dnd_cf7_uploader.drag_n_drop_upload.inavalid_type+'</span>'),k=!0),localStorage.setItem(e,Number(localStorage.getItem(e))+1),k===!1&&(f.append('upload-file',s),j=new XMLHttpRequest,i=document.getElementById(q),m=i.querySelector('.dnd-progress-bar'),n=i.querySelector('.dnd-upload-details'),h=g.querySelector('input[type="submit"]'),j.open(g.getAttribute('method'),a.ajax_url),j.onreadystatechange=function(){if(this.readyState===4)if(this.status===200){var c=JSON.parse(this.responseText);c.success?(d.setProgressBar(q,100),typeof a.on_success=="function"&&a.on_success.call(this,b,q,c)):(m.remove(),n.insertAdjacentHTML('beforeend','<span class="has-error">'+c.data+'</span>'),h.classList.remove('disabled'),h.removeAttribute('disabled'),i.classList.remove('in-progress'))}else m.remove(),n.insertAdjacentHTML('beforeend','<span class="has-error">'+a.server_max_error+'</span>'),h.classList.remove('disabled'),h.removeAttribute('disabled'),i.classList.remove('in-progress')},j.upload.addEventListener("progress",function(a){var b,c;a.lengthComputable&&(b=a.loaded/a.total,c=parseInt(b*100),d.setProgressBar(q,c-1))},!1),j.send(f))}},d={createProgressBar:function(b){var f=c.querySelector('.codedropz-upload-handler'),g='dnd-file-'+Math.random().toString(36).substr(2,9),h=`
                    <div class="dnd-upload-image">
                        <span class="file"></span>
                    </div>
                    <div class="dnd-upload-details">
                        <span class="name"><span>${b.name}</span><em>(${d.bytesToSize(b.size)})</em></span>
                        <a href="javascript:void(0)" title="${dnd_cf7_uploader.drag_n_drop_upload.delete.title}" class="remove-file" data-storage="${e}">
                        <span class="dnd-icon-remove"></span>
                        </a>
                        <span class="dnd-progress-bar"><span></span></span>
                    </div>
                `,a=document.createElement('div');return a.id=g,a.className='dnd-upload-status',a.innerHTML=h,f.parentNode.insertBefore(a,f.nextSibling),g},setProgressBar:function(e,b){const c=document.getElementById(e),a=c.querySelector('.dnd-progress-bar');if(a){d.disableBtn(k);let e=b*a.offsetWidth/100;c.classList.add('in-progress'),b==100?(a.querySelector('span').style.width='100%',a.querySelector('span').textContent=`${b}% `):(a.querySelector('span').style.width=e+'px',a.querySelector('span').textContent=`${b}% `),b==100&&(c.classList.add('complete'),c.classList.remove('in-progress'))}return!1},bytesToSize:function(a){return a===0?'0':(kBytes=a/1024,fileSize=kBytes>=1024?(kBytes/1024).toFixed(2)+'MB':kBytes.toFixed(2)+'KB',fileSize)},disableBtn:function(a){a&&(a.classList.add('disable'),a.disabled=!0)}}};document.addEventListener("click",function(g){var a,b,d,e,f,c;if(!g.target.classList.contains("dnd-icon-remove"))return;if(a=g.target,b=a.closest(".dnd-upload-status"),d=a.closest(".codedropz-upload-wrapper"),e=a.parentElement.getAttribute("data-storage"),f=Number(localStorage.getItem(e)),b.classList.contains("in-progress")||b.querySelector(".has-error"))return b.remove(),localStorage.setItem(e,f-1),!1;a.classList.add("deleting"),a.textContent=dnd_cf7_uploader.drag_n_drop_upload.delete.text+"...",c=new XMLHttpRequest,c.open("POST",dnd_cf7_uploader.ajax_url),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.onload=function(){if(this.status===200){var a=JSON.parse(this.responseText);a.success&&(b.remove(),localStorage.setItem(e,f-1),d.querySelectorAll(".dnd-upload-status").length<=1&&d.querySelector(".has-error-msg")&&d.querySelector(".has-error-msg").remove(),d.querySelector(".dnd-upload-counter span").textContent=Number(localStorage.getItem(e))-1)}},c.send("path="+b.querySelector('input[type="hidden"]').value+"&action=dnd_codedropz_upload_delete"+"&security="+dnd_cf7_uploader.ajax_nonce),document.querySelectorAll(".has-error-msg").forEach(function(a){a.remove()})}),HTMLElement.prototype.CodeDropz_Uploader=a})(),document.addEventListener('DOMContentLoaded',function(){document.addEventListener('wpcf7mailsent',function(f){var b,c,d,e;const a=f.target;b=a.querySelectorAll('.wpcf7-drag-n-drop-file'),c=a.querySelectorAll('.dnd-upload-status'),d=a.querySelector('.dnd-upload-counter span'),e=a.querySelectorAll('span.has-error-msg'),b.length>0&&b.forEach(function(a){localStorage.setItem(a.getAttribute('data-name')+'_count_files',1)}),c&&c.forEach(function(a){a.remove()}),d&&(d.textContent='0'),e&&e.forEach(function(a){a.remove()})},!1),window.initDragDrop=function(){var a=dnd_cf7_uploader.drag_n_drop_upload,b=document.querySelectorAll('.wpcf7-drag-n-drop-file');b.forEach(function(b){b.CodeDropz_Uploader({color:'#fff',ajax_url:dnd_cf7_uploader.ajax_url,text:a.text,separator:a.or_separator,button_text:a.browse,server_max_error:a.server_max_error,on_success:function(a,h,e){var f=document.querySelector('.codedropz-upload-wrapper #'+h),d=a.closest('form'),b=d.querySelector('.wpcf7-acceptance'),g=b?b.querySelector('input[type="checkbox"]'):'',i,j,k,l;const c=a.closest('.codedropz-upload-wrapper').nextElementSibling;c&&c.classList.contains('wpcf7-not-valid-tip')&&c.remove(),(b&&b.classList.contains('optional')||!b||g.checked||d.classList.contains('wpcf7-acceptance-as-validation'))&&setTimeout(function(){d.querySelector('input[type="submit"]').removeAttribute('disabled')},1),i=f.querySelector('.dnd-upload-details'),j='<span><input type="hidden" name="'+a.dataset.name+'[]" value="'+e.data.path+'/'+e.data.file+'"></span>',i.insertAdjacentHTML('beforeend',j),k=Number(localStorage.getItem(a.dataset.name+'_count_files'))-1,l=a.closest('.codedropz-upload-wrapper').querySelector('.dnd-upload-counter span'),l.textContent=k}})})},window.initDragDrop()})